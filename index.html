<meta charset=utf-8>
<script src='svg.js'></script>
<script>
onload=function(){
  svg=new SVG(300,300);
  svg.trans={x:10,y:10,w:1,h:1};
  var lw=svg.lineWidth=0.1;
  var thickness=3;
  var w=60;
  var l=60;
  var curve=60;
  var duktaRatio=0.75;
  var duktaW=4;
  function dukta(x1,y1,x2,y2,i){
    var dw=3;
    if(i%2==0){
      var a,b,c,d;
      a=1/4-duktaRatio/4;
      b=1/4+duktaRatio/4;
      c=3/4-duktaRatio/4;
      d=3/4+duktaRatio/4;
      duktabase(x1+a*(x2-x1),y1+a*(y2-y1),x1+b*(x2-x1),y1+b*(y2-y1),dw);
      duktabase(x1+c*(x2-x1),y1+c*(y2-y1),x1+d*(x2-x1),y1+d*(y2-y1),dw);
    }else{
      var a=duktaRatio/4;
      var b=1/2-duktaRatio/4;
      var c=1/2+duktaRatio/4;
      var d=1-duktaRatio/4;
      svg.line([{x:x1,y:y1},{x:x1+a*(x2-x1),y:y1+a*(y2-y1)}]);
      duktabase(x1+b*(x2-x1),y1+b*(y2-y1),x1+c*(x2-x1),y1+c*(y2-y1),dw);
      svg.line([{x:x1+d*(x2-x1),y:y1+d*(y2-y1)},{x:x2,y:y2}]);
    }
  }
  function duktabase(x1,y1,x2,y2,w){
    var h=Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1));
    var h2=w*6
    if(h2>=h)throw 'error'
    var x=(x1+x2)/2,y=(y1+y2)/2;
    var points=[
      {x:0,y:-0.5*h2},
      {x:0,y:-0.4*h2},
      {x:-w/5,y:-0.3*h2},
      {x:-w/3,y:-0.2*h2},
      {x:-w/3,y:-0.1*h2},
      {x:0,y:-0.1*h2},
      {x:w/3,y:-0.2*h2},
      {x:w*2/3,y:-0.1*h2},
      {x:w*2/3,y:0.1*h2},
      {x:w/3,y:0.2*h2},
      {x:0,y:0.1*h2},
      {x:-w/3,y:0.1*h2},
      {x:-w/3,y:0.2*h2},
      {x:-w/5,y:0.3*h2},
      {x:0,y:0.4*h2},
      {x:0,y:0.5*h2}
    ];
    var t=Math.atan2(x2-x1,y2-y1);
    var cos=Math.cos(t),sin=Math.sin(t);
    points=points.map(function(p){
      return {x: x+p.x*cos+p.y*sin, y:y+p.y*cos-p.x*sin};
    });
    points.unshift({x:x1,y:y1})
    points.push({x:x2,y:y2})
    svg.curve(points);
  }
  for(var i=1;i<20;i++){
    var x=i*3;
    var y=0;
    dukta(x,y,x,y+l,i);
  }
  svg.line([{x:0,y:0},{x:0,y:l},{x:60,y:l},{x:60,y:0}],true)


  var img=new Image();
  img.src=svg.toDataURL();
  img.style.border='1px solid red'
  document.body.appendChild(img);
}

</script>